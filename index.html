<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Assistant</title>
    <link rel="shortcut icon" href="logo.png" type="image/x-icon">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Protest+Guerrilla&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Merriweather", serif;
        }

        ::-webkit-scrollbar {
            display: none;
        }

        body {
            width: 100%;
            height: 100%;
            background-color: black;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 30px;
            flex-direction: column;
            font-family: "Merriweather", serif;
            padding: 20px;
        }

        #logo {
            width: 20vw;
            max-width: 150px;
        }

        h1 {
            color: aliceblue;
            font-family: "Protest Guerrilla", sans-serif;
            letter-spacing: 1px;
            font-weight: 400;
            text-align: center;
        }

        #voice {
            width: 100px;
            display: none;
        }


        #btn {
            width: 40%;
            width: max-content;
            background: linear-gradient(to right, rgb(255, 105, 180), rgb(70, 130, 180));
            padding: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            font-size: 1.2rem;
            border-radius: 20px;
            color: white;
            box-shadow: 0 0 10px rgba(255, 182, 193, 0.4), 0 0 10px rgba(135, 206, 235, 0.4);
            border: none;
            transition: all 0.5s;
            cursor: pointer;
        }

        #btn:hover {
            box-shadow: 0 0 20px rgba(255, 182, 193, 0.4), 0 0 20px rgba(135, 206, 235, 0.4);
            letter-spacing: 1px;
        }

        #commands {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            width: 100%;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .command-btn {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 15px;
            font-size: 0.8rem;
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.5);
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 120px;
            text-align: center;
            white-space: normal;
            word-wrap: break-word;
            margin: 0 4px;
            letter-spacing: 1px;
        }

        .command-btn:hover {
            background-color: rgba(255, 255, 255, 0.4);
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }

        #news-container {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            width: 95%;
            margin: 0 auto;
            text-align: left;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.2);
            color: aliceblue;
            display: none;
        }

        #news-container ul {
            list-style: none;
            padding: 0;
        }

        #news-container li {
            background-color: rgba(255, 255, 255, 0.2);
            margin: 10px 0;
            padding: 10px;
            border-radius: 8px;
            cursor: pointer;
        }

        #news-container li a {
            color: aliceblue;
            text-decoration: none;
        }

        #news-container li:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        /* News section header and refresh icon */
        #news-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        #refresh-icon {
            cursor: pointer;
            width: 24px;
            height: 24px;
            margin-left: 10px;
            transition: transform 0.3s;
            filter: invert(100%);
        }

        #refresh-icon:hover {
            transform: rotate(360deg);
        }


        #definition {
            background: transparent;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
            max-width: 95%;
            margin: 20px auto;
            font-family: "Merriweather", serif;
            color: #f0f8ff;
            text-align: left;
        }

        #definition h3 {
            font-size: 1.5em;
            margin: 15px 0;
            color: #fff;
        }

        #definition p {
            margin: 10px 0;
            line-height: 1.6;
        }

        #definition strong {
            color: #ffcccb;
        }


        @media screen and (max-width: 768px) {
            body {
                padding: 10px;
            }

            #logo {
                width: 30%;
            }

            #btn {
                width: 70%;
                font-size: 1rem;
                max-width: 300px;
            }

            h1 {
                font-size: 1.5rem;
            }

            #commands {
                font-size: 0.8rem;
            }

            .command-btn {
                min-width: 90px;
                padding: 8px 12px;
                font-size: 0.7rem;
            }
        }
    </style>
</head>

<body>
    <img src="logo.png" alt="logo" id="logo">
    <h1>Your Virtual Assistant</h1>

    <!-- Marquee sections for commands -->
    <div id="commands">
        <marquee behavior="scroll" direction="left" scrollamount="7" onmouseover="this.stop()"
            onmouseout="this.start()">
            <button class="command-btn" data-command="what is apple">"What is apple?" - Get the meaning of
                "apple"</button>
            <button class="command-btn" data-command="hello">"Hello" or "Hey" - Greet the assistant</button>
            <button class="command-btn" data-command="translate this to french good morning">"Translate this to French"
                - "Good morning"</button>
            <button class="command-btn" data-command="news">"News" - Get the latest news</button>
            <button class="command-btn" data-command="translate this to japanese what is your name?">"Translate this to
                Japanese" - "What is your name?"</button>
            <button class="command-btn" data-command="open youtube">"Open YouTube" - Open YouTube</button>
            <button class="command-btn" data-command="what is democracy">"What is democracy?" - Get the meaning of
                "democracy"</button>
            <button class="command-btn" data-command="translate this to arabic please help me">"Translate this to
                Arabic" - "Please help me"</button>
            <button class="command-btn" data-command="open google">"Open Google" - Open Google</button>
            <button class="command-btn" data-command="solve 2+2">"Solve" - Solve mathematical equations 2 + 2</button>
            <button class="command-btn" data-command="who are you">"Who are you?" - Learn about the assistant</button>
            <button class="command-btn" data-command="time">"Time" - Get the current time</button>
            <button class="command-btn" data-command="search">"Search" - Search for something</button>
            <button class="command-btn" data-command="set reminder">"Set Reminder" - Add a reminder</button>
            <button class="command-btn" data-command="advice">"Advice" - Get a word of wisdom</button>
            <button class="command-btn" data-command="weather">"Weather" - Get weather updates</button>
            <button class="command-btn" data-command="translate this to spanish how are you?">"Translate this to
                Spanish" - "How are you?"</button>
            <button class="command-btn" data-command="quote">"Quote" - Get an inspirational quote</button>
            <button class="command-btn" data-command="joke">"Joke" - Hear a joke</button>
            <button class="command-btn" data-command="open google maps">"Open Google Maps" - Open Google Maps</button>
            <button class="command-btn" data-command="shayari">"Shayari" - Hear a poetic line</button>
            <button class="command-btn" data-command="open youtube">"Open YouTube" - Open YouTube</button>
        </marquee>

        <marquee behavior="scroll" direction="right" scrollamount="5" onmouseover="this.stop()"
            onmouseout="this.start()">
            <button class="command-btn" data-command="hello">"Hello" or "Hey" - Greet the assistant</button>
            <button class="command-btn" data-command="who are you">"Who are you?" - Learn about the assistant</button>
            <button class="command-btn" data-command="open youtube">"Open YouTube" - Open YouTube</button>
            <button class="command-btn" data-command="open google">"Open Google" - Open Google</button>
            <button class="command-btn" data-command="weather">"Weather" - Get weather updates</button>
            <button class="command-btn" data-command="news">"News" - Get the latest news</button>
            <button class="command-btn" data-command="time">"Time" - Get the current time</button>
            <button class="command-btn" data-command="date">"Date" - Get the current date</button>
            <button class="command-btn" data-command="set reminder">"Set Reminder" - Add a reminder</button>
            <button class="command-btn" data-command="advice">"Advice" - Get a word of wisdom</button>
            <button class="command-btn" data-command="joke">"Joke" - Hear a joke</button>
            <button class="command-btn" data-command="quote">"Quote" - Get an inspirational quote</button>
            <button class="command-btn" data-command="search">"Search" - Search for something</button>
            <button class="command-btn" data-command="play music">"Play Music" - Play some tunes</button>
            <button class="command-btn" data-command="what is apple">"What is apple?" - Get the meaning of
                "apple"</button>
            <button class="command-btn" data-command="hello">"Hello" or "Hey" - Greet the assistant</button>
            <button class="command-btn" data-command="translate this to french good morning">"Translate this to French"
                - "Good morning"</button>
            <button class="command-btn" data-command="news">"News" - Get the latest news</button>
            <button class="command-btn" data-command="translate this to japanese what is your name?">"Translate this to
                Japanese" - "What is your name?"</button>
            <button class="command-btn" data-command="open youtube">"Open YouTube" - Open YouTube</button>
            <button class="command-btn" data-command="what is democracy">"What is democracy?" - Get the meaning of
                "democracy"</button>
            <button class="command-btn" data-command="translate this to arabic please help me">"Translate this to
                Arabic" - "Please help me"</button>
            <button class="command-btn" data-command="open google">"Open Google" - Open Google</button>
            <button class="command-btn" data-command="solve 2+2">"Solve" - Solve mathematical equations 2 + 2</button>
            <button class="command-btn" data-command="who are you">"Who are you?" - Learn about the assistant</button>
            <button class="command-btn" data-command="time">"Time" - Get the current time</button>
            <button class="command-btn" data-command="search">"Search" - Search for something</button>
            <button class="command-btn" data-command="set reminder">"Set Reminder" - Add a reminder</button>
            <button class="command-btn" data-command="advice">"Advice" - Get a word of wisdom</button>
            <button class="command-btn" data-command="weather">"Weather" - Get weather updates</button>
            <button class="command-btn" data-command="translate this to spanish how are you?">"Translate this to
                Spanish" - "How are you?"</button>
            <button class="command-btn" data-command="quote">"Quote" - Get an inspirational quote</button>
            <button class="command-btn" data-command="joke">"Joke" - Hear a joke</button>
            <button class="command-btn" data-command="open google maps">"Open Google Maps" - Open Google Maps</button>
            <button class="command-btn" data-command="shayari">"Shayari" - Hear a poetic line</button>
            <button class="command-btn" data-command="open youtube">"Open YouTube" - Open YouTube</button>
        </marquee>

        <marquee behavior="scroll" direction="left" scrollamount="6" onmouseover="this.stop()"
            onmouseout="this.start()">
            <button class="command-btn" data-command="what is apple">"What is apple?" - Get the meaning of
                "apple"</button>
            <button class="command-btn" data-command="hello">"Hello" or "Hey" - Greet the assistant</button>
            <button class="command-btn" data-command="translate this to french good morning">"Translate this to French"
                - "Good morning"</button>
            <button class="command-btn" data-command="news">"News" - Get the latest news</button>
            <button class="command-btn" data-command="translate this to japanese what is your name?">"Translate this to
                Japanese" - "What is your name?"</button>
            <button class="command-btn" data-command="open youtube">"Open YouTube" - Open YouTube</button>
            <button class="command-btn" data-command="what is democracy">"What is democracy?" - Get the meaning of
                "democracy"</button>
            <button class="command-btn" data-command="translate this to arabic please help me">"Translate this to
                Arabic" - "Please help me"</button>
            <button class="command-btn" data-command="open google">"Open Google" - Open Google</button>
            <button class="command-btn" data-command="solve 2+2">"Solve" - Solve mathematical equations 2 + 2</button>
            <button class="command-btn" data-command="who are you">"Who are you?" - Learn about the assistant</button>
            <button class="command-btn" data-command="time">"Time" - Get the current time</button>
            <button class="command-btn" data-command="search">"Search" - Search for something</button>
            <button class="command-btn" data-command="set reminder">"Set Reminder" - Add a reminder</button>
            <button class="command-btn" data-command="weather">"Weather" - Get weather updates</button>
            <button class="command-btn" data-command="translate this to spanish how are you?">"Translate this to
                Spanish" - "How are you?"</button>
            <button class="command-btn" data-command="quote">"Quote" - Get an inspirational quote</button>
            <button class="command-btn" data-command="joke">"Joke" - Hear a joke</button>
            <button class="command-btn" data-command="open google maps">"Open Google Maps" - Open Google Maps</button>
            <button class="command-btn" data-command="shayari">"Shayari" - Hear a poetic line</button>
            <button class="command-btn" data-command="open youtube">"Open YouTube" - Open YouTube</button>
        </marquee>
    </div>

    <!-- Microphone Button -->
    <img src="voice.gif" alt="voice" id="voice">
    <button id="btn"><img src="mic.svg" alt="mic"><span id="content"> Click here to talk to me</span></button>

    <!-- News Section -->
    <div id="news-container">
        <div id="news-header">
            <span>Latest News</span>
            <img id="refresh-icon" src="https://img.icons8.com/ios/452/synchronize.png" alt="refresh"
                onclick="fetchNews()">
        </div>
        <ul id="news-list"></ul>
    </div>

    <div id="definition" style="color: aliceblue;">
    </div>

    <script>
        let btn = document.querySelector("#btn");
        let content = document.querySelector("#content");
        let voice = document.querySelector("#voice");
        let commands = document.querySelector("#commands");
        let newsContainer = document.querySelector("#news-container");
        let newsFrame = document.querySelector("#news-frame");


        let lastFetchedIndex = 0; // Keep track of the last index of stories we fetched

        // Fetch latest news from Hacker News API
        async function fetchNews() {
            try {
                // Fetch the top stories from Hacker News
                const response = await fetch('https://hacker-news.firebaseio.com/v0/topstories.json?print=pretty');
                const storyIds = await response.json();

                // Change the range of stories that we fetch each time
                const storiesPerBatch = 10;
                const startIdx = lastFetchedIndex;
                const endIdx = lastFetchedIndex + storiesPerBatch;
                const nextBatch = storyIds.slice(startIdx, endIdx);

                // Update the last fetched index for the next batch
                lastFetchedIndex = endIdx;

                // If we've reached the end of the story list, reset the index
                if (lastFetchedIndex >= storyIds.length) {
                    lastFetchedIndex = 0;
                }

                // Clear existing news
                const newsList = document.getElementById('news-list');
                newsList.innerHTML = '';

                // Fetch details for each news item
                for (let id of nextBatch) {
                    const storyResponse = await fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json?print=pretty`);
                    const storyData = await storyResponse.json();

                    // Create a list item with a link
                    const li = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = storyData.url;
                    link.target = "_blank";
                    link.textContent = storyData.title;

                    li.appendChild(link);
                    newsList.appendChild(li);
                }
            } catch (error) {
                console.error("Error fetching news:", error);
                const newsList = document.getElementById('news-list');
                newsList.innerHTML = '<li>Failed to load news. Please try again later.</li>';
            }
        }

        // Call the function to load news when the page loads
        window.onload = fetchNews;

        function speak(text) {
            let text_speak = new SpeechSynthesisUtterance(text);
            text_speak.rate = 1;
            text_speak.pitch = 1;
            text_speak.volume = 1;
            text_speak.lang = "en-US";
            window.speechSynthesis.speak(text_speak);
        }

        function wishMe() {
            let day = new Date();
            let hours = day.getHours();
            if (hours >= 0 && hours < 12) {
                speak("Good Morning!");
            } else if (hours >= 12 && hours < 16) {
                speak("Good Afternoon!");
            } else {
                speak("Good Evening!");
            }
        }

        let speechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
        let recognition = new speechRecognition();

        recognition.onresult = (event) => {
            let currentIndex = event.resultIndex;
            let transcript = event.results[currentIndex][0].transcript;
            content.innerText = transcript;
            takeCommand(transcript.toLowerCase());
        };

        btn.addEventListener("click", () => {
            recognition.start();
            voice.style.display = "block";
            btn.style.display = "none";
        });

        function takeCommand(message) {
            voice.style.display = "none";
            btn.style.display = "flex";

            if (message.includes("hello") || message.includes("hey")) {
                speak("Hello! How can I assist you?");
            } else if (message.includes("who are you")) {
                speak("I am your virtual assistant, here to help you.");
            } else if (message.includes("open")) {
                const appName = message.split("open ")[1];
                speak(`Opening ${appName}...`);

                const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
                const isAndroid = /Android/i.test(navigator.userAgent);
                const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);

                // Comprehensive deep linking dictionary
                const appDeepLinks = {
                    // Social Media & Messaging
                    'whatsapp': {
                        android: 'intent://send#Intent;scheme=whatsapp;package=com.whatsapp;end',
                        ios: 'whatsapp://send',
                        web: 'https://web.whatsapp.com/'
                    },
                    'facebook': {
                        android: 'intent://facebook.com/#Intent;scheme=https;package=com.facebook.katana;end',
                        ios: 'fb://profile',
                        web: 'https://www.facebook.com/'
                    },
                    'instagram': {
                        android: 'intent://instagram.com/#Intent;scheme=https;package=com.instagram.android;end',
                        ios: 'instagram://app',
                        web: 'https://www.instagram.com/'
                    },
                    'twitter': {
                        android: 'intent://twitter.com/#Intent;scheme=https;package=com.twitter.android;end',
                        ios: 'twitter://timeline',
                        web: 'https://twitter.com/'
                    },
                    'telegram': {
                        android: 'intent://resolve/#Intent;scheme=tg;package=org.telegram.messenger;end',
                        ios: 'tg://resolve',
                        web: 'https://web.telegram.org/'
                    },
                    'snapchat': {
                        android: 'intent://snap.com/#Intent;scheme=https;package=com.snapchat.android;end',
                        ios: 'snapchat://',
                        web: 'https://www.snapchat.com/'
                    },
                    'linkedin': {
                        android: 'intent://linkedin.com/#Intent;scheme=https;package=com.linkedin.android;end',
                        ios: 'linkedin://',
                        web: 'https://www.linkedin.com/'
                    },
                    'discord': {
                        android: 'intent://discord.com/#Intent;scheme=https;package=com.discord;end',
                        ios: 'discord://',
                        web: 'https://discord.com/'
                    },

                    // Entertainment & Media
                    'youtube': {
                        android: 'intent://youtube.com/#Intent;scheme=https;package=com.google.android.youtube;end',
                        ios: 'youtube://',
                        web: 'https://www.youtube.com/'
                    },
                    'spotify': {
                        android: 'intent://open.spotify.com/#Intent;scheme=https;package=com.spotify.music;end',
                        ios: 'spotify://',
                        web: 'https://open.spotify.com/'
                    },
                    'netflix': {
                        android: 'intent://netflix.com/#Intent;scheme=https;package=com.netflix.mediaclient;end',
                        ios: 'netflix://',
                        web: 'https://www.netflix.com/'
                    },
                    'tiktok': {
                        android: 'intent://vm.tiktok.com/#Intent;scheme=https;package=com.zhiliaoapp.musically;end',
                        ios: 'tiktok://',
                        web: 'https://www.tiktok.com/'
                    },

                    // Productivity & Utilities
                    'gmail': {
                        android: 'intent://mail.google.com/#Intent;scheme=https;package=com.google.android.gm;end',
                        ios: 'googlegmail:///',
                        web: 'https://mail.google.com/'
                    },
                    'google maps': {
                        android: 'intent://maps.google.com/#Intent;scheme=https;package=com.google.android.apps.maps;end',
                        ios: 'comgooglemaps://',
                        web: 'https://www.google.com/maps'
                    },
                    'zoom': {
                        android: 'intent://zoom.us/#Intent;scheme=https;package=us.zoom.videomeetings;end',
                        ios: 'zoomus://',
                        web: 'https://zoom.us/'
                    },
                    'skype': {
                        android: 'intent://skype.com/#Intent;scheme=https;package=com.skype.raider;end',
                        ios: 'skype://',
                        web: 'https://web.skype.com/'
                    },

                    // E-commerce & Shopping
                    'amazon': {
                        android: 'intent://amazon.com/#Intent;scheme=https;package=com.amazon.mobile.shopping;end',
                        ios: 'amazon://',
                        web: 'https://www.amazon.com/'
                    },
                    'pinterest': {
                        android: 'intent://pinterest.com/#Intent;scheme=https;package=com.pinterest;end',
                        ios: 'pinterest://',
                        web: 'https://www.pinterest.com/'
                    },
                    'reddit': {
                        android: 'intent://reddit.com/#Intent;scheme=https;package=com.reddit.frontpage;end',
                        ios: 'reddit://',
                        web: 'https://www.reddit.com/'
                    }
                };

                // Normalize app name for lookup
                const normalizedAppName = appName.toLowerCase().trim();

                if (isMobile) {
                    if (appDeepLinks[normalizedAppName]) {
                        try {
                            if (isAndroid) {
                                window.location.href = appDeepLinks[normalizedAppName].android;
                            } else if (isIOS) {
                                window.location.href = appDeepLinks[normalizedAppName].ios;
                            } else {
                                window.location.href = appDeepLinks[normalizedAppName].web;
                            }
                        } catch (error) {
                            console.error(`Error opening ${appName}:`, error);
                            window.location.href = appDeepLinks[normalizedAppName].web;
                        }
                    } else {
                        // Fallback to web URL if app not found
                        window.open(`https://${normalizedAppName}.com/`, '_blank');
                    }
                } else {
                    // For non-mobile devices, open web version
                    window.open(`https://${normalizedAppName}.com/`, '_blank');
                }
            } else if (message.includes("weather")) {
                speak("Fetching the weather...");
                window.open("https://www.weather.com/", "_blank");
            } else if (message.includes("news")) {
                speak("Fetching the latest news...");
                commands.style.display = "none";
                newsContainer.style.display = "block";
            } else if (message.includes("time")) {
                let time = new Date().toLocaleTimeString([], { hour: "2-digit", minute: "2-digit" });
                speak(`The current time is ${time}`);
            } else if (message.includes("date")) {
                let date = new Date().toLocaleDateString([], { day: "numeric", month: "long", year: "numeric" });
                speak(`Today's date is ${date}`);
            } else if (message.includes("set reminder")) {
                speak("Sure! What should I remind you about?");
                setTimeout(() => {
                    speak("This feature is under development, but I’ll remember your command for next time!");
                }, 2000);
            } else if (message.includes("thank you")) {
                speak("You're welcome!");
            } else if (message.includes("refresh") || message.includes("reload")) {
                speak("Refreshing the page...");
                location.reload(); // Reload the current page
            } else if (message.startsWith("translate this to")) {
                // Extract the target language and the text
                const parts = message.split("translate this to ");
                const targetLanguage = parts[1]?.split(" ")[0]?.trim().toLowerCase(); // Get the first word after 'translate this to'
                const textToTranslate = parts[1]?.replace(targetLanguage, "").trim(); // The rest is the text to translate

                if (!targetLanguage || !textToTranslate) {
                    speak("Please specify both the language and the text to translate. For example, 'translate this to Spanish how are you?'");
                    return;
                }

                // Language codes for translation
                const languageCodes = {
                    spanish: "es",
                    arabic: "ar",
                    chinese: "zh",
                    japanese: "ja",
                    korean: "ko",
                    russian: "ru",
                    french: "fr",
                    german: "de",
                    italian: "it",
                    hindi: "hi",
                    urdu: "ur",
                    english: "en",
                };

                const languageCode = languageCodes[targetLanguage];
                if (!languageCode) {
                    speak(`Sorry, I don't support translation to ${targetLanguage} yet. Supported languages are: ${Object.keys(languageCodes).join(", ")}.`);
                    return;
                }

                // Call the translation API (using LibreTranslate or MyMemory)
                fetch(`https://api.mymemory.translated.net/get?q=${encodeURIComponent(textToTranslate)}&langpair=en|${languageCode}`)
                    .then((response) => response.json())
                    .then((data) => {
                        const translatedText = data.responseData.translatedText;

                        // Speak and display the translation
                        speak(`The translation is: ${translatedText}`);
                        document.getElementById("definition").innerHTML = `
        <div class="card">
          <h3>🌍 Translation Result:</h3>
          <p><strong>Original:</strong> ${textToTranslate}</p>
          <p><strong>Translated (${targetLanguage}):</strong> ${translatedText}</p>
        </div>`;
                    })
                    .catch((error) => {
                        console.error("Translation API error:", error);
                        speak("Sorry, there was an error translating the text. Please try again.");
                        document.getElementById("definition").innerHTML = `
        <div class="card">
          <h3>❌ Translation Error:</h3>
          <p>Sorry, there was an error. Please try again later.</p>
        </div>`;
                    });
            }
            else if (message.includes("what is")) {
                // Extract the word from the message
                const word = message.split(" ").pop().toLowerCase();

                // Use an external API to fetch the meaning
                fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`)
                    .then((response) => {
                        if (!response.ok) {
                            throw new Error("Word not found");
                        }
                        return response.json();
                    })
                    .then((data) => {
                        // Parse and display the meaning
                        const meanings = data[0].meanings.map((meaning) => {
                            return `<p><strong>${meaning.partOfSpeech}:</strong> ${meaning.definitions[0].definition}</p>`;
                        }).join("");

                        // Speak and display the result
                        speak(`${meanings}`);
                        document.getElementById("definition").innerHTML = `
            <div class="card">
                <h3>📖 Definition of ${word.toUpperCase()}:</h3>
                ${meanings}
            </div>`;
                    })
                    .catch(() => {
                        // Handle errors (word not found)
                        speak(`Sorry, I couldn't find the meaning of ${word}.`);
                        document.getElementById("definition").innerHTML = `
            <div class="card">
                <h3>❌ Word not found:</h3>
                <p>The word "${word}" could not be found in the dictionary. Please try another word.</p>
            </div>`;
                    });
            } else if (message.includes("joke")) {
                speak("Here's a joke for you!");
                fetchJoke();
            } else if (message.includes("play music")) {
                openMusicApp();
            } else if (message.includes("quote")) {
                speak("Here's an inspirational quote for you!");
                fetchInspirationalQuote();
            } else if (message.includes("shayari")) {
                speak("Here's a beautiful Shayari for you!");
                fetchShayari();
            } else if (message.includes("advice")) {
                speak("Here's a piece of advice for you!");
                fetchAdvice();
            } else if (message.toLowerCase().startsWith("solve")) {
                speak("Let me help you solve that equation!");
                solveMathEquation(message);
            }
        }

        // Auto wish on load
        window.addEventListener('load', () => {
            wishMe();
        });

        // Adding functionality for command buttons to trigger the same as speaking
        document.querySelectorAll('.command-btn').forEach(button => {
            button.addEventListener('click', () => {
                let command = button.getAttribute('data-command');
                takeCommand(command.toLowerCase());
            });
        });

        // Function to reset the interface back to commands
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape') {
                newsContainer.style.display = "none";
                commands.style.display = "block";
                speak("Back to commands menu.");
            }
        });

        async function fetchJoke() {
            try {
                const response = await fetch('https://v2.jokeapi.dev/joke/Any?blacklistFlags=nsfw,racist,sexist,explicit&type=single');
                const data = await response.json();

                if (data.joke) {
                    speak(data.joke);
                    document.getElementById("definition").innerHTML = `
                        <div class="card">
                            <h3>😄 Joke of the Moment:</h3>
                            <p>${data.joke}</p>
                        </div>`;
                } else {
                    speak("Sorry, I couldn't fetch a joke right now.");
                }
            } catch (error) {
                console.error("Error fetching joke:", error);
                speak("Oops! Something went wrong while fetching a joke.");
            }
        }

        function openMusicApp() {
            // Check platform
            const isAndroid = /Android/i.test(navigator.userAgent);
            const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
            const isMobile = isAndroid || isIOS;

            if (isMobile) {
                // Mobile-specific deep links
                try {
                    // First, try Spotify
                    if (isAndroid) {
                        window.location.href = "intent://spotify.com/#Intent;scheme=spotify;package=com.spotify.music;end";
                    } else {
                        window.location.href = "spotify://";
                    }
                    speak("Opening Spotify");
                    return;
                } catch (spotifyError) {
                    try {
                        // If Spotify fails, try YouTube Music
                        if (isAndroid) {
                            window.location.href = "intent://youtube.com/music/#Intent;scheme=https;package=com.google.android.apps.youtube.music;end";
                        } else {
                            window.location.href = "youtubemusic://";
                        }
                        speak("Opening YouTube Music");
                        return;
                    } catch (ytmError) {
                        // Fallback to default music app
                        try {
                            if (isAndroid) {
                                // Android default music player
                                window.location.href = "intent:#Intent;action=android.intent.action.MAIN;category=android.intent.category.APP_MUSIC;end";
                            } else {
                                // iOS default music app
                                window.location.href = "music://";
                            }
                            speak("Opening default music app");
                        } catch (defaultError) {
                            // If all else fails
                            speak("Could not open any music app. Please open manually.");
                        }
                    }
                }
            } else {
                // For desktop, open Spotify or YouTube Music web
                window.open("https://open.spotify.com/", "_blank");
                speak("Opening Spotify in a new tab");
            }
        }

        // Static fallback quotes array
        const staticQuotes = [
            {
                quote: "Believe you can and you're halfway there.",
                author: "Theodore Roosevelt"
            },
            {
                quote: "The only way to do great work is to love what you do.",
                author: "Steve Jobs"
            },
            {
                quote: "Success is not final, failure is not fatal: it is the courage to continue that counts.",
                author: "Winston Churchill"
            },
            {
                quote: "In the middle of every difficulty lies opportunity.",
                author: "Albert Einstein"
            },
            {
                quote: "Your time is limited, don't waste it living someone else's life.",
                author: "Steve Jobs"
            },
            {
                quote: "The future belongs to those who believe in the beauty of their dreams.",
                author: "Eleanor Roosevelt"
            },
            {
                quote: "Don't watch the clock; do what it does. Keep going.",
                author: "Sam Levenson"
            },
            {
                quote: "Happiness is not something ready-made. It comes from your own actions.",
                author: "Dalai Lama"
            },
            {
                quote: "The only limit to our realization of tomorrow will be our doubts of today.",
                author: "Franklin D. Roosevelt"
            },
            {
                quote: "You are never too old to set another goal or to dream a new dream.",
                author: "C.S. Lewis"
            },
            {
                quote: "Do what you can, with what you have, where you are.",
                author: "Theodore Roosevelt"
            },
            {
                quote: "It does not matter how slowly you go as long as you do not stop.",
                author: "Confucius"
            },
            {
                quote: "Keep your face always toward the sunshine, and shadows will fall behind you.",
                author: "Walt Whitman"
            },
            {
                quote: "Act as if what you do makes a difference. It does.",
                author: "William James"
            },
            {
                quote: "Opportunities don't happen. You create them.",
                author: "Chris Grosser"
            },
            {
                quote: "Hardships often prepare ordinary people for an extraordinary destiny.",
                author: "C.S. Lewis"
            },
            {
                quote: "The best way to predict the future is to create it.",
                author: "Peter Drucker"
            },
            {
                quote: "The only thing standing between you and your goal is the story you keep telling yourself.",
                author: "Jordan Belfort"
            },
            {
                quote: "If you want to achieve greatness, stop asking for permission.",
                author: "Anonymous"
            },
            {
                quote: "Everything you’ve ever wanted is on the other side of fear.",
                author: "George Addair"
            },
            {
                quote: "Dream big and dare to fail.",
                author: "Norman Vaughan"
            },
            {
                quote: "The secret of getting ahead is getting started.",
                author: "Mark Twain"
            },
            {
                quote: "Quality means doing it right when no one is looking.",
                author: "Henry Ford"
            },
            {
                quote: "Perseverance is not a long race; it is many short races one after the other.",
                author: "Walter Elliot"
            },
            {
                quote: "We may encounter many defeats, but we must not be defeated.",
                author: "Maya Angelou"
            },
            {
                quote: "A goal without a plan is just a wish.",
                author: "Antoine de Saint-Exupéry"
            },
            {
                quote: "Great things never come from comfort zones.",
                author: "Anonymous"
            },
            {
                quote: "If you’re going through hell, keep going.",
                author: "Winston Churchill"
            },
            {
                quote: "Doubt kills more dreams than failure ever will.",
                author: "Suzy Kassem"
            },
            {
                quote: "Courage is resistance to fear, mastery of fear, not absence of fear.",
                author: "Mark Twain"
            },
            {
                quote: "I find that the harder I work, the more luck I seem to have.",
                author: "Thomas Jefferson"
            },
            {
                quote: "Don't be pushed around by the fears in your mind. Be led by the dreams in your heart.",
                author: "Roy T. Bennett"
            },
            {
                quote: "The way to get started is to quit talking and begin doing.",
                author: "Walt Disney"
            }
        ];

        async function fetchInspirationalQuote() {
            try {
                // Primary API fetch
                const response = await fetch('https://api.quotable.io/random?tags=inspirational');

                if (!response.ok) {
                    throw new Error('API fetch failed');
                }

                const data = await response.json();

                if (data.content) {
                    speak(`${data.content} - ${data.author}`);
                    document.getElementById("definition").innerHTML = `
                <div class="card">
                    <h3>✨ Inspirational Quote:</h3>
                    <p>"${data.content}"</p>
                    <p><strong>- ${data.author}</strong></p>
                </div>`;
                } else {
                    throw new Error('No quote content');
                }
            } catch (error) {
                // Fallback to static quotes
                console.error("API quote fetch failed, using static quotes:", error);

                // Select a random quote from static quotes
                const fallbackQuote = staticQuotes[Math.floor(Math.random() * staticQuotes.length)];

                speak(`${fallbackQuote.quote} - ${fallbackQuote.author}`);
                document.getElementById("definition").innerHTML = `
            <div class="card">
                <h3>✨ Inspirational Quote:</h3>
                <p>"${fallbackQuote.quote}"</p>
                <p><strong>- ${fallbackQuote.author}</strong></p>
            </div>`;
            }
        }

        async function fetchAdvice() {
            try {
                const response = await fetch('https://api.adviceslip.com/advice');

                if (!response.ok) {
                    throw new Error('Advice API fetch failed');
                }

                const data = await response.json();

                if (data.slip && data.slip.advice) {
                    speak(data.slip.advice);
                    document.getElementById("definition").innerHTML = `
                <div class="card">
                    <h3>💡 Words of Wisdom:</h3>
                    <p>"${data.slip.advice}"</p>
                </div>`;
                } else {
                    throw new Error('No advice content');
                }
            } catch (error) {
                console.error("Advice fetch failed:", error);

                // Predefined advice as fallback
                const staticAdvice = [
                    "Take one step at a time.",
                    "Believe in yourself and your abilities.",
                    "Every day is a new opportunity.",
                    "Focus on progress, not perfection.",
                    "Be kind to yourself and others.",
                    "Learn from your mistakes.",
                    "Stay positive and patient.",
                    "Your attitude determines your direction.",
                    "Small steps lead to big changes.",
                    "Trust the journey, not the destination."
                ];

                const fallbackAdvice = staticAdvice[Math.floor(Math.random() * staticAdvice.length)];

                speak(fallbackAdvice);
                document.getElementById("definition").innerHTML = `
            <div class="card">
                <h3>💡 Words of Wisdom:</h3>
                <p>"${fallbackAdvice}"</p>
            </div>`;
            }
        }

        async function fetchShayari() {
            // Local fallback Shayari collection
            const urduShayariCollections = [
                {
                    shayari: "دل کی بات زبان پر آتی ہے",
                    author: "فیض احمد فیض"
                },
                {
                    shayari: "محبت کی راہوں میں بھٹکتا ہوا دل",
                    author: "غالب"
                },
                {
                    shayari: "آنکھوں میں آنسو، دل میں طوفان",
                    author: "احمد فراز"
                },
                {
                    shayari: "یہ نہ تھی ہماری قسمت کہ وصالِ یار ہوتا",
                    author: "مرزا غالب"
                },
                {
                    shayari: "محبت میں ہم نے یہ نقصان دیکھا، جو دل کے قریب تھا وہی انجان دیکھا",
                    author: "نامعلوم"
                },
                {
                    shayari: "سنا ہے لوگ اسے آنکھ بھر کے دیکھتے ہیں، سو اس کے شہر میں کچھ دن قیام کرنا ہے",
                    author: "جون ایلیا"
                },
                {
                    shayari: "عشق نے غالب نکما کر دیا، ورنہ ہم بھی آدمی تھے کام کے",
                    author: "مرزا غالب"
                },
                {
                    shayari: "دنیا کے ستم یاد نہ اپنی ہی وفا یاد، اب مجھ کو نہیں کچھ بھی محبت کے سوا یاد",
                    author: "احمد فراز"
                },
                {
                    shayari: "تجھے بھول جانے کی کوشش میں، میں آج بھی خود کو بھلا رہا ہوں",
                    author: "نامعلوم"
                },
                {
                    shayari: "تمہاری یاد کے جب زخم بھرنے لگتے ہیں، کسی بہانے تمہیں یاد کرنے لگتے ہیں",
                    author: "ناصر کاظمی"
                },
                {
                    shayari: "کسی کے عشق میں دنیا لٹا کے بیٹھے ہیں، جنہیں خود کی خبر نہیں وہ دعا کے بیٹھے ہیں",
                    author: "نامعلوم"
                },
                {
                    shayari: "وہ عشق جو ہم سے روٹھ گیا، اب اس کا حال نہ پوچھو دوستو",
                    author: "نامعلوم"
                },
                {
                    shayari: "محبت کرنے والے کم نہ ہوں گے، تیری محفل میں لیکن ہم نہ ہوں گے",
                    author: "فیض احمد فیض"
                },
                {
                    shayari: "تجھ سے بچھڑ کے فرق بس اتنا پڑا، تجھ کو یاد کیا، خود کو بھلا دیا",
                    author: "نامعلوم"
                },
                {
                    shayari: "کبھی جو کھو گیا میں، مجھے ڈھونڈ لینا، تیرے دل کے آس پاس ہی ہوں گا",
                    author: "نامعلوم"
                },
                {
                    shayari: "یادیں ماضی کی خوشبو کی طرح ہوتی ہیں، جنہیں جتنا دباؤ وہ اتنی مہک دیتی ہیں",
                    author: "نامعلوم"
                },
                {
                    shayari: "دل ہی تو ہے نہ سنگ و خشت، درد سے بھر نہ آئے کیوں",
                    author: "مرزا غالب"
                },
                {
                    shayari: "چاندنی راتوں میں تیرا انتظار، دل کو ہر پل ہے بےقرار",
                    author: "نامعلوم"
                },
                {
                    shayari: "یہ جو سجدوں میں نظر آتے ہیں، ان کے دل ٹوٹے ہوئے ہوتے ہیں",
                    author: "نامعلوم"
                },
                {
                    shayari: "ہم بھی دریا ہیں، ہمیں اپنا ہنر معلوم ہے، جس طرف بھی چل پڑیں گے راستہ ہو جائے گا",
                    author: "جون ایلیا"
                },
                {
                    shayari: "دل سے جو بات نکلتی ہے اثر رکھتی ہے، پر نہیں طاقت پرواز مگر رکھتی ہے",
                    author: "علامہ اقبال"
                },
                {
                    shayari: "غمِ ہجر کی رات ہے دراز بہت، صبح کر دو اگر تمھیں اختیار ہو",
                    author: "فیض احمد فیض"
                },
                {
                    shayari: "ہم کو معلوم ہے جنت کی حقیقت لیکن، دل کے خوش رکھنے کو غالب یہ خیال اچھا ہے",
                    author: "مرزا غالب"
                }
            ];


            try {
                // First, try Rapid API
                const rapidApiResponse = await fetch('https://shayari-api.p.rapidapi.com/shayari', {
                    method: 'GET',
                    headers: {
                        'X-RapidAPI-Key': 'YOUR_RAPID_API_KEY', // Replace with your actual RapidAPI key
                        'X-RapidAPI-Host': 'shayari-api.p.rapidapi.com'
                    }
                });

                // Check if Rapid API response is successful
                if (rapidApiResponse.ok) {
                    const data = await rapidApiResponse.json();
                    if (data && data.shayari) {
                        return displayShayari(data.shayari, data.author || "Unknown Poet");
                    }
                }

                // If Rapid API fails, try alternative API
                const alternativeApiResponse = await fetch('https://api.example.com/urdu-shayari', {
                    method: 'GET',
                    headers: {
                        'Authorization': 'Bearer YOUR_ALTERNATIVE_API_KEY' // Replace with alternative API key
                    }
                });

                // Check if alternative API response is successful
                if (alternativeApiResponse.ok) {
                    const data = await alternativeApiResponse.json();
                    if (data && data.text) {
                        return displayShayari(data.text, data.author || "Unknown Poet");
                    }
                }

                // If both APIs fail, use local fallback
                const randomShayari = urduShayariCollections[Math.floor(Math.random() * urduShayariCollections.length)];
                return displayShayari(randomShayari.shayari, randomShayari.author);

            } catch (error) {
                console.error("Shayari Fetching Error:", error);

                // Final fallback
                const randomShayari = urduShayariCollections[Math.floor(Math.random() * urduShayariCollections.length)];
                return displayShayari(randomShayari.shayari, randomShayari.author);
            }

            // Internal function to display Shayari
            function displayShayari(shayari, author) {
                // Speak the Shayari
                speak(`${shayari} - ${author}`);

                // Display in the definition area
                document.getElementById("definition").innerHTML = `
        <div class="card">
            <h3>📜 اردو شاعری:</h3>
            <p class="urdu-text" style="direction: rtl; text-align: right; font-family: 'Urdu Typesetting', Arial, sans-serif;">
                "${shayari}"
            </p>
            <p class="urdu-author" style="direction: rtl; text-align: left; font-family: 'Urdu Typesetting', Arial, sans-serif;">
                <strong>- ${author}</strong>
            </p>
        </div>`;
            }
        }

        async function solveMathEquation(equation) {
            // Remove "solve" from the beginning of the equation and trim
            const cleanEquation = equation.replace(/^solve\s*/i, '').trim();

            try {
                // First, try some basic local math solving
                let solution;

                // Try MathJS first if available
                if (typeof math !== 'undefined') {
                    try {
                        solution = math.evaluate(cleanEquation).toString();
                        return displaySolution(cleanEquation, solution);
                    } catch { }
                }

                // Try safe evaluation
                try {
                    // Whitelist of allowed characters and patterns
                    const safePattern = /^[0-9+\-*/().^ ]+$/;

                    if (safePattern.test(cleanEquation)) {
                        const sanitizedEquation = cleanEquation.replace(/[^\w().+\-*/^ ]/g, '');
                        solution = Function(`"use strict"; return (${sanitizedEquation})`)().toString();
                        return displaySolution(cleanEquation, solution);
                    }
                } catch { }

                // If local methods fail, try API
                try {
                    const response = await fetch('https://api.deepseek.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer sk-f86a179c3fdc43d6ab22779bc16e15a2' // Replace with your actual API key
                        },
                        body: JSON.stringify({
                            model: "deepseek-coder",
                            messages: [
                                {
                                    role: "system",
                                    content: "You are a precise mathematical assistant. Solve the given mathematical equation step-by-step."
                                },
                                {
                                    role: "user",
                                    content: `Solve this mathematical equation precisely: ${cleanEquation}`
                                }
                            ],
                            temperature: 0.2,
                            max_tokens: 300
                        })
                    });

                    if (response.ok) {
                        const data = await response.json();
                        solution = data.choices[0]?.message?.content;

                        if (solution) {
                            return displaySolution(cleanEquation, solution);
                        }
                    }
                } catch { }

                // If all methods fail
                throw new Error('Unable to solve the equation');

            } catch (error) {
                console.error("Error solving mathematical equation:", error);

                // Error display
                speak("Sorry, I couldn't solve the equation.");
                document.getElementById("definition").innerHTML = `
        <div class="card">
            <h3>❌ Equation Solving Error:</h3>
            <p><strong>Equation:</strong> ${cleanEquation}</p>
            <p>Unable to solve the equation. Please check the syntax.</p>
        </div>`;
            }

            // Internal helper to display solution
            function displaySolution(equation, solution) {
                speak(solution);
                document.getElementById("definition").innerHTML = `
        <div class="card">
            <h3>🧮 Mathematical Solution:</h3>
            <p><strong>Equation:</strong> ${equation}</p>
            <p><strong>Solution:</strong> ${solution}</p>
        </div>`;
            }
        }
    </script>
</body>

</html>
